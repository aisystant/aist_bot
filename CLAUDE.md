# CLAUDE.md — AIST Track Bot

> **Общие инструкции:** см. `/Users/tserentserenov/Github/CLAUDE.md`
>
> Этот файл содержит только специфику данного репозитория.

---

## 1. Тип репозитория

**Downstream-instrument** — Telegram-бот марафона личного развития.

**НЕ является source-of-truth** — определения в Pack'ах.

---

## 2. Терминология

**ВСЕГДА используй термины из [docs/ontology.md](docs/ontology.md).**

### 2.1. Краткая справка

| Термин | Что это |
|--------|---------|
| **Ученик** | Пользователь Марафона |
| **Читатель** | Пользователь Ленты |
| **Марафон** | 14-дневная программа |
| **Лента** | Гибкое обучение по дайджестам |
| **Урок** | Теория в Марафоне |
| **Задание** | Практика в Марафоне |
| **Дайджест** | Ежедневный материал в Ленте |
| **Фиксация** | Личный вывод Читателя |

### 2.2. Соответствие кода и терминов

| Термин | В коде сейчас | Целевое имя |
|--------|---------------|-------------|
| Урок | `theory` | `lesson` |
| Задание | `practice` | `task` |
| Дайджест | `feed_session` | `digest` |

---

## 3. Структура проекта

```
aist_bot/
├── bot.py              # Марафон
├── engines/feed/       # Лента
├── db/                 # База данных
├── config/             # Настройки
└── docs/
    ├── ontology.md     # ТЕРМИНОЛОГИЯ
    ├── scenarios/      # Сценарии (пользователь ↔ бот)
    ├── processes/      # Процессы (внутренняя логика)
    └── data/           # Данные (модель БД)
```

---

## 4. Три уровня документации

| Категория | Описывает | Папка |
|-----------|-----------|-------|
| **Сценарий** | Взаимодействие с ботом | `docs/scenarios/` |
| **Процесс** | Внутренняя логика | `docs/processes/` |
| **Данные** | Структура БД | `docs/data/` |

---

## 5. Правила разработки

### 5.1. При изменении кода — СПРОСИ

**Любое изменение кода требует:**
1. Определить категорию (Сценарий/Процесс/Данные)
2. Спросить: "Это изменение затронет [категория]. Подтвердите?"
3. Дождаться подтверждения
4. Код + документация в одном коммите

### 5.2. При изменении терминологии

1. Сначала обнови `docs/ontology.md`
2. Получи подтверждение
3. Затем меняй код

### 5.3. README.md

Изменять **только с явного согласия пользователя**.

---

## 6. Работа с ветками

| Ветка | Назначение |
|-------|------------|
| `main` | Production |
| `new-architecture` | State Machine (в разработке) |

### После изменения в main

Спросить: *"Это изменение нужно синхронизировать с веткой new-architecture?"*

---

## 7. Чеклист перед коммитом

### Терминология
- [ ] Термины соответствуют `docs/ontology.md`
- [ ] Сообщения пользователю на русском
- [ ] Код использует английские имена

### Документация
- [ ] Пользователь подтвердил изменения
- [ ] Затронутые Сценарии обновлены
- [ ] Затронутые Процессы обновлены
- [ ] Затронутые Данные обновлены

---

## 8. Частые ошибки

| Неправильно | Правильно |
|-------------|-----------|
| "контент" (в Ленте) | Дайджест |
| "тема" | Урок / Задание / Дайджест |
| "сессия" | Дайджест / День |
| "рефлексия" | Фиксация |
| "пользователь" | Ученик / Читатель |
