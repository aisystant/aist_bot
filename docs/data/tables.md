# –¢–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

> –ü–æ–ª–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Ç–∞–±–ª–∏—Ü –∏ –∏—Ö –ø–æ–ª–µ–π. –ò—Å—Ç–æ—á–Ω–∏–∫: `db/models.py`

---

## interns (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

> –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞.

### –ü—Ä–æ—Ñ–∏–ª—å

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `chat_id` | BIGINT | ‚Äî | PK, Telegram chat ID |
| `name` | TEXT | `''` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `occupation` | TEXT | `''` | –†–æ–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| `role` | TEXT | `''` | –†–æ–ª—å –≤ —Ä–∞–±–æ—Ç–µ |
| `domain` | TEXT | `''` | –û–±–ª–∞—Å—Ç—å –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| `interests` | TEXT | `'[]'` | –ò–Ω—Ç–µ—Ä–µ—Å—ã (JSON –º–∞—Å—Å–∏–≤) |
| `motivation` | TEXT | `''` | –ú–æ—Ç–∏–≤–∞—Ü–∏—è –∫ –æ–±—É—á–µ–Ω–∏—é |
| `goals` | TEXT | `''` | –¶–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è |

### –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `language` | TEXT | `'ru'` | –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (ru/en/es/fr) |
| `experience_level` | TEXT | `''` | –£—Ä–æ–≤–µ–Ω—å –æ–ø—ã—Ç–∞ |
| `difficulty_preference` | TEXT | `''` | –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å |
| `learning_style` | TEXT | `''` | –°—Ç–∏–ª—å –æ–±—É—á–µ–Ω–∏—è |
| `study_duration` | INTEGER | `15` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–Ω—è—Ç–∏—è (–º–∏–Ω) |
| `schedule_time` | TEXT | `'09:00'` | –í—Ä–µ–º—è –∑–∞–Ω—è—Ç–∏–π |
| `current_problems` | TEXT | `''` | –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã |
| `desires` | TEXT | `''` | –ü–æ–∂–µ–ª–∞–Ω–∏—è |
| `topic_order` | TEXT | `'default'` | –ü–æ—Ä—è–¥–æ–∫ —Ç–µ–º |

### –†–µ–∂–∏–º—ã –∏ State Machine

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `mode` | TEXT | `'marathon'` | –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º (marathon/feed) |
| `current_state` | TEXT | `'common.start'` | üÜï –¢–µ–∫—É—â–∏–π —Å—Ç–µ–π—Ç State Machine |
| `current_context` | TEXT | `'{}'` | –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (JSON) |

### –ú–∞—Ä–∞—Ñ–æ–Ω

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `marathon_status` | TEXT | `'not_started'` | –°—Ç–∞—Ç—É—Å –ú–∞—Ä–∞—Ñ–æ–Ω–∞ |
| `marathon_start_date` | DATE | NULL | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ú–∞—Ä–∞—Ñ–æ–Ω–∞ |
| `marathon_paused_at` | DATE | NULL | –î–∞—Ç–∞ –ø–∞—É–∑—ã |
| `current_topic_index` | INTEGER | `0` | –¢–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å —Ç–µ–º—ã |
| `completed_topics` | TEXT | `'[]'` | –ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —Ç–µ–º—ã (JSON) |
| `topics_today` | INTEGER | `0` | –¢–µ–º –ø—Ä–æ–π–¥–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è |
| `last_topic_date` | DATE | NULL | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–µ–º—ã |

### –°–ª–æ–∂–Ω–æ—Å—Ç—å

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `complexity_level` | INTEGER | `1` | –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (1-3) |
| `topics_at_current_complexity` | INTEGER | `0` | –¢–µ–º –Ω–∞ —Ç–µ–∫—É—â–µ–º —É—Ä–æ–≤–Ω–µ |

### –õ–µ–Ω—Ç–∞

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `feed_status` | TEXT | `'not_started'` | –°—Ç–∞—Ç—É—Å –õ–µ–Ω—Ç—ã |
| `feed_started_at` | DATE | NULL | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –õ–µ–Ω—Ç—ã |

### –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–æ—Å—Ç—å (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `active_days_total` | INTEGER | `0` | –í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–Ω–µ–π |
| `active_days_streak` | INTEGER | `0` | –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è |
| `longest_streak` | INTEGER | `0` | –†–µ–∫–æ—Ä–¥ —Å–µ—Ä–∏–∏ |
| `last_active_date` | DATE | NULL | –ü–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å |

### –°—Ç–∞—Ç—É—Å—ã –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `onboarding_completed` | BOOLEAN | `FALSE` | –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –∑–∞–≤–µ—Ä—à—ë–Ω |
| `created_at` | TIMESTAMP | `NOW()` | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ |
| `updated_at` | TIMESTAMP | `NOW()` | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

---

## answers (–û—Ç–≤–µ—Ç—ã)

> –û—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ –∑–∞–¥–∞–Ω–∏—è.

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `id` | SERIAL | ‚Äî | PK |
| `chat_id` | BIGINT | ‚Äî | FK ‚Üí interns |
| `mode` | TEXT | `'marathon'` | –†–µ–∂–∏–º (marathon/feed) |
| `topic_index` | INTEGER | ‚Äî | –ò–Ω–¥–µ–∫—Å —Ç–µ–º—ã |
| `topic_id` | TEXT | ‚Äî | ID —Ç–µ–º—ã |
| `feed_session_id` | INTEGER | ‚Äî | FK ‚Üí feed_sessions |
| `answer_type` | TEXT | `'theory_answer'` | –¢–∏–ø –æ—Ç–≤–µ—Ç–∞ |
| `answer` | TEXT | ‚Äî | –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ |
| `work_product_category` | TEXT | ‚Äî | –ö–∞—Ç–µ–≥–æ—Ä–∏—è –†–ü |
| `complexity_level` | INTEGER | ‚Äî | –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ |
| `created_at` | TIMESTAMP | `NOW()` | –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ |

**–¢–∏–ø—ã –æ—Ç–≤–µ—Ç–æ–≤ (`answer_type`):**
| –ó–Ω–∞—á–µ–Ω–∏–µ | –¢–µ—Ä–º–∏–Ω –æ–Ω—Ç–æ–ª–æ–≥–∏–∏ | –†–µ–∂–∏–º |
|----------|-----------------|-------|
| `theory_answer` | –û—Ç–≤–µ—Ç –Ω–∞ —É—Ä–æ–∫ | –ú–∞—Ä–∞—Ñ–æ–Ω |
| `work_product` | –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ (–†–ü) | –ú–∞—Ä–∞—Ñ–æ–Ω |
| `bonus_answer` | –û—Ç–≤–µ—Ç –Ω–∞ –±–æ–Ω—É—Å | –ú–∞—Ä–∞—Ñ–æ–Ω |
| `fixation` | –§–∏–∫—Å–∞—Ü–∏—è | –õ–µ–Ω—Ç–∞ |

---

## activity_log (–õ–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)

> –ó–∞–ø–∏—Å—å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ streak.

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `id` | SERIAL | ‚Äî | PK |
| `chat_id` | BIGINT | ‚Äî | FK ‚Üí interns |
| `activity_date` | DATE | ‚Äî | –î–∞—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| `activity_type` | TEXT | ‚Äî | –¢–∏–ø –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| `mode` | TEXT | ‚Äî | –†–µ–∂–∏–º (marathon/feed) |
| `reference_id` | INTEGER | ‚Äî | ID —Å–≤—è–∑–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏ |
| `created_at` | TIMESTAMP | `NOW()` | –í—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ |

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- `UNIQUE(chat_id, activity_date, activity_type)` ‚Äî –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å —Ç–∏–ø–∞ –≤ –¥–µ–Ω—å

**–ò–Ω–¥–µ–∫—Å—ã:**
- `idx_activity_date ON (chat_id, activity_date)`

**–¢–∏–ø—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (`activity_type`):**
| –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –†–µ–∂–∏–º |
|----------|----------|-------|
| `theory_answer` | –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å —É—Ä–æ–∫–∞ | –ú–∞—Ä–∞—Ñ–æ–Ω |
| `work_product` | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ | –ú–∞—Ä–∞—Ñ–æ–Ω |
| `bonus_answer` | –û—Ç–≤–µ—Ç –Ω–∞ –±–æ–Ω—É—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å | –ú–∞—Ä–∞—Ñ–æ–Ω |
| `feed_fixation` | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ | –õ–µ–Ω—Ç–∞ |

---

## feed_weeks (–ù–µ–¥–µ–ª–∏ –õ–µ–Ω—Ç—ã)

> –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–µ–ª—å –≤ —Ä–µ–∂–∏–º–µ –õ–µ–Ω—Ç—ã.

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `id` | SERIAL | ‚Äî | PK |
| `chat_id` | BIGINT | ‚Äî | FK ‚Üí interns |
| `week_number` | INTEGER | ‚Äî | –ù–æ–º–µ—Ä –Ω–µ–¥–µ–ª–∏ |
| `week_start` | DATE | ‚Äî | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏ |
| `suggested_topics` | TEXT | `'[]'` | –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–µ–º—ã (JSON) |
| `accepted_topics` | TEXT | `'[]'` | –ü—Ä–∏–Ω—è—Ç—ã–µ —Ç–µ–º—ã (JSON) |
| `current_day` | INTEGER | `0` | –¢–µ–∫—É—â–∏–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ |
| `status` | TEXT | `'planning'` | –°—Ç–∞—Ç—É—Å –Ω–µ–¥–µ–ª–∏ |
| `ended_at` | TIMESTAMP | ‚Äî | –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è |
| `created_at` | TIMESTAMP | `NOW()` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

**–°—Ç–∞—Ç—É—Å—ã (`status`):**
| –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `planning` | –í—ã–±–æ—Ä —Ç–µ–º |
| `active` | –ê–∫—Ç–∏–≤–Ω–∞—è –Ω–µ–¥–µ–ª—è |
| `completed` | –ó–∞–≤–µ—Ä—à–µ–Ω–∞ |

---

## feed_sessions (–°–µ—Å—Å–∏–∏ –õ–µ–Ω—Ç—ã / –î–∞–π–¥–∂–µ—Å—Ç—ã)

> –î–∞–π–¥–∂–µ—Å—Ç—ã, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∂–∏–º–µ –õ–µ–Ω—Ç—ã.

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `id` | SERIAL | ‚Äî | PK |
| `week_id` | INTEGER | ‚Äî | FK ‚Üí feed_weeks |
| `day_number` | INTEGER | ‚Äî | –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (1-7) |
| `topic_title` | TEXT | ‚Äî | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã |
| `content` | TEXT | `'{}'` | –¢–µ–∫—Å—Ç –¥–∞–π–¥–∂–µ—Å—Ç–∞ (JSON) |
| `session_date` | DATE | ‚Äî | –î–∞—Ç–∞ —Å–µ—Å—Å–∏–∏ |
| `status` | TEXT | `'active'` | –°—Ç–∞—Ç—É—Å |
| `fixation_text` | TEXT | ‚Äî | –¢–µ–∫—Å—Ç —Ñ–∏–∫—Å–∞—Ü–∏–∏ |
| `completed_at` | TIMESTAMP | ‚Äî | –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è |
| `created_at` | TIMESTAMP | `NOW()` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

**–°—Ç–∞—Ç—É—Å—ã (`status`):**
| –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `active` | –û–∂–∏–¥–∞–µ—Ç —Ñ–∏–∫—Å–∞—Ü–∏–∏ |
| `completed` | –§–∏–∫—Å–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ |

---

## reminders (–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)

> –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `id` | SERIAL | ‚Äî | PK |
| `chat_id` | BIGINT | ‚Äî | FK ‚Üí interns |
| `reminder_type` | TEXT | ‚Äî | –¢–∏–ø –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è |
| `scheduled_for` | TIMESTAMP | ‚Äî | –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ |
| `sent` | BOOLEAN | `FALSE` | –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–∏ |
| `created_at` | TIMESTAMP | `NOW()` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

---

## qa_history (–ò—Å—Ç–æ—Ä–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤)

> –í–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –±–æ—Ç–∞.

| –ü–æ–ª–µ | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------|----------|
| `id` | SERIAL | ‚Äî | PK |
| `chat_id` | BIGINT | ‚Äî | FK ‚Üí interns |
| `mode` | TEXT | ‚Äî | –†–µ–∂–∏–º |
| `context_topic` | TEXT | ‚Äî | –¢–µ–º–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |
| `question` | TEXT | ‚Äî | –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `answer` | TEXT | ‚Äî | –û—Ç–≤–µ—Ç –±–æ—Ç–∞ (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è) |
| `mcp_sources` | TEXT | `'[]'` | –ò—Å—Ç–æ—á–Ω–∏–∫–∏ MCP (JSON) |
| `created_at` | TIMESTAMP | `NOW()` | –í—Ä–µ–º—è –≤–æ–ø—Ä–æ—Å–∞ |

---

## –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

```
interns (chat_id)
    ‚îÇ
    ‚îú‚îÄ‚îÄ answers (chat_id)
    ‚îÇ       ‚îî‚îÄ‚îÄ feed_session_id ‚Üí feed_sessions
    ‚îÇ
    ‚îú‚îÄ‚îÄ activity_log (chat_id)
    ‚îÇ
    ‚îú‚îÄ‚îÄ feed_weeks (chat_id)
    ‚îÇ       ‚îî‚îÄ‚îÄ feed_sessions (week_id)
    ‚îÇ
    ‚îú‚îÄ‚îÄ reminders (chat_id)
    ‚îÇ
    ‚îî‚îÄ‚îÄ qa_history (chat_id)
```

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| 2026-01-23 | –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ü–æ–ª–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –∏–∑ `db/models.py` |
| 2026-02-03 | –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `current_state` –¥–ª—è State Machine |
