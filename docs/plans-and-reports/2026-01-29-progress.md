# Отчёт о прогрессе за 25-29 января 2026

## Ветка main (основной бот) — 24 коммита

### 1. Исправления отображения прогресса
- Устранены ошибки в `/progress` — некорректный расчёт дней до завершения
- Исправлена работа с `FSMContext` (state=None) — бот падал при некоторых сценариях
- Улучшена обработка ошибок в `marathon_learn` с полным traceback

**Зачем:** Стабильность production-бота, пользователи получают корректную статистику.

### 2. Инфраструктурные исправления
- Переименование `test-repo` → `test_repo` для совместимости с Python-импортами
- Обновлён compliance checker для процесса P-01 (отслеживание активности)
- Добавлены автоматические отчёты соответствия сценариям

**Зачем:** Автоматизация проверки качества — код проверяется на соответствие документации.

---

## Ветка new-architecture (новый бот) — 76 коммитов

### 1. State Machine — полная инфраструктура

```
states/
├── base.py              # Базовый класс состояний
├── registry.py          # Автоматическая регистрация
├── common/              # Общие состояния
│   ├── start.py         # Онбординг
│   ├── mode_select.py   # Выбор режима
│   ├── consultation.py  # Консультации
│   └── error.py         # Обработка ошибок
├── workshops/marathon/  # Марафон
│   ├── lesson.py        # Урок (теория)
│   ├── question.py      # Вопрос урока
│   ├── task.py          # Задание
│   └── bonus.py         # Бонусный вопрос
└── feed/                # Лента
    ├── topics.py        # Выбор тем
    └── digest.py        # Дайджест
```

**Зачем:** Каждое состояние изолировано и тестируемо. Легко добавлять новые режимы (консультант, экзокортекс).

### 2. Модульная система i18n (интернационализация)

```
i18n/
├── schema.yaml       # Схема всех ключей
├── loader.py         # Загрузчик переводов
├── checker.py        # Проверка полноты
└── translations/     # Файлы переводов
```

**Зачем:** Все строки UI вынесены из кода. Добавление нового языка = 1 YAML-файл.

### 3. Полная локализация UI
- Все захардкоженные строки переведены на i18n
- Исправлено смешивание языков (названия тем, кнопки)
- Документирован процесс P-05 (локализация)

**Зачем:** Готовность к многоязычной аудитории без изменений кода.

---

## Что дальше

### Краткосрочные задачи

| Задача | Описание | Что даст |
|--------|----------|----------|
| **Подключение ORY** | Единый вход для всех ботов Aisystant | Связка Telegram ID ↔ аккаунт ORY, единая авторизация |
| **Миграция Index Bot → Aist** | Перевод заметочника на новую архитектуру | Бот заметок станет частью единой системы |
| **Цифровой двойник** | E2E тесты + staging-окружение | Проверка перед production, уверенность в релизах |

### Режимы консультанта (новые применения)

| Режим | Состояние | Описание |
|-------|-----------|----------|
| **Тестирование мастерства** | `ConsultantMasteryState` | Оценка уровня владения темой через диалог |
| **Создание экзокортекса** | `ConsultantExocortexState` | Помощь в структурировании личной базы знаний |
| **Помощь родителю** | `ConsultantParentState` | Адаптированные объяснения для передачи детям |
| **Стратег** | `StrategistState` | Помощь в формулировании стратегий |
| **Артефактор** | `ArtifactorState` | Создание рабочих продуктов |

Архитектура State Machine позволяет добавлять каждый новый режим как независимый модуль в `states/consultants/`.

---

## Статус документации

| Раздел | Статус | Последнее обновление |
|--------|--------|---------------------|
| `docs/data/tables.md` | ✅ Актуален | 2026-01-23 |
| `docs/data/metrics.md` | ✅ Актуален | 2026-01-25 |
| `docs/processes/` | ✅ Актуален | 2026-01-25 |
| `docs/scenarios/` | ✅ Актуален | 2026-01-25 |
